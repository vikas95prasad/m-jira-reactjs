{"ast":null,"code":"import { authHeader } from '../_helpers';\n\nvar axios = require('axios');\n\nvar apiHost = 'http://' + (process.env.API_HOST || 'localhost') + ':5000';\nvar jwt = false;\n\nif (localStorage.getItem('user')) {\n  jwt = JSON.parse(localStorage.getItem('user')).token;\n}\n\nexport var userService = {\n  login: login,\n  logout: logout,\n  getAll: getAll,\n  getProjects: getProjects,\n  createProject: createProject,\n  getTodos: getTodos,\n  createTodo: createTodo,\n  getUsers: getUsers\n}; //####### Start Users API #######\n\nfunction getUsers(payload) {\n  var config = {\n    headers: {}\n  };\n\n  if (jwt) {\n    config['headers']['Authorization'] = 'Bearer ' + jwt;\n  }\n\n  return axios.get(apiHost + '/api/users', payload, config).then(function (response) {\n    return response.data;\n  }).catch(function (error) {\n    return undefined;\n  });\n} //####### End Todo API #######\n//####### Start Login API #######\n\n\nfunction login(username, password) {\n  var data = {\n    email: username,\n    password: password\n  };\n  return axios.post(apiHost + '/api/users/login', data).then(function (response) {\n    localStorage.setItem('user', JSON.stringify(response.data.user));\n  }).catch(function (error) {\n    return undefined;\n  });\n}\n\nfunction logout() {\n  localStorage.removeItem('user');\n} //####### End Login API #######\n//####### Start Project API #######\n\n\nfunction getProjects(payload) {\n  var config = {\n    headers: {}\n  };\n\n  if (jwt) {\n    config['headers']['Authorization'] = 'Bearer ' + jwt;\n  }\n\n  return axios.get(apiHost + '/api/projects', config).then(function (response) {\n    return response.data;\n  }).catch(function (error) {\n    return undefined;\n  });\n}\n\nfunction createProject(payload) {\n  var config = {\n    headers: {}\n  };\n\n  if (jwt) {\n    config['headers']['Authorization'] = 'Bearer ' + jwt;\n  }\n\n  return axios.post(apiHost + '/api/projects', payload, config).then(function (response) {\n    return response.data;\n  }).catch(function (error) {\n    return undefined;\n  });\n} //####### End Project API #######\n//####### Start Todo API #######\n\n\nfunction getTodos(payload) {\n  var config = {\n    headers: {}\n  };\n\n  if (jwt) {\n    config['headers']['Authorization'] = 'Bearer ' + jwt;\n  }\n\n  return axios.get(apiHost + '/api/todos', config).then(function (response) {\n    return response.data;\n  }).catch(function (error) {\n    return undefined;\n  });\n}\n\nfunction createTodo(payload) {\n  var config = {\n    headers: {}\n  };\n\n  if (jwt) {\n    config['headers']['Authorization'] = 'Bearer ' + jwt;\n  }\n\n  return axios.post(apiHost + '/api/todos', payload, config).then(function (response) {\n    return response.data;\n  }).catch(function (error) {\n    return undefined;\n  });\n} //####### End Todo API #######\n\n\nfunction getAll() {\n  var requestOptions = {\n    method: 'GET',\n    headers: authHeader()\n  };\n  return fetch(\"/users\", requestOptions).then(handleResponse);\n}\n\nfunction handleResponse(response) {\n  return response.text().then(function (text) {\n    var data = text && JSON.parse(text);\n\n    if (!response.ok) {\n      if (response.status === 401) {\n        // auto logout if 401 response returned from api\n        logout(); // location.reload(true);\n      }\n\n      var error = data && data.message || response.statusText;\n      return Promise.reject(error);\n    }\n\n    return data;\n  });\n}","map":{"version":3,"sources":["/Users/vikas/Downloads/react-redux-jwt-authentication-example-w5tqfu/src/_services/user.service.js"],"names":["authHeader","axios","require","apiHost","process","env","API_HOST","jwt","localStorage","getItem","JSON","parse","token","userService","login","logout","getAll","getProjects","createProject","getTodos","createTodo","getUsers","payload","config","headers","get","then","response","data","catch","error","undefined","username","password","email","post","setItem","stringify","user","removeItem","requestOptions","method","fetch","handleResponse","text","ok","status","message","statusText","Promise","reject"],"mappings":"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","sourcesContent":["import { authHeader } from '../_helpers';\nvar axios = require('axios')\n\nlet apiHost = 'http://' + (process.env.API_HOST || 'localhost') + ':5000'\n\nlet jwt = false\nif (localStorage.getItem('user')){\n  jwt = JSON.parse(localStorage.getItem('user')).token\n}\n\nexport const userService = {\n    login,\n    logout,\n    getAll,\n    getProjects,\n    createProject,\n    getTodos,\n    createTodo,\n    getUsers\n};\n\n//####### Start Users API #######\nfunction getUsers(payload){\n  var config = {\n    headers: {}\n  }\n  if (jwt) {\n    config['headers']['Authorization'] = 'Bearer ' + jwt\n  }\n  return axios.get(apiHost + '/api/users', payload, config)\n    .then(function(response){\n      return response.data\n    })\n    .catch(function (error) {\n      return undefined\n  })\n}\n\n\n//####### End Todo API #######\n\n//####### Start Login API #######\nfunction login(username, password) {\n    let data = {\n      email: username,\n      password: password\n    }\n    return axios.post(apiHost + '/api/users/login', data)\n      .then(function (response) {\n        localStorage.setItem('user', JSON.stringify(response.data.user));\n      })\n      .catch(function (error) {\n        return undefined\n      })\n}\n\nfunction logout() {\n  localStorage.removeItem('user');\n}\n\n//####### End Login API #######\n\n\n//####### Start Project API #######\nfunction getProjects(payload) {\n  var config = {\n    headers: {}\n  }\n  if (jwt) {\n    config['headers']['Authorization'] = 'Bearer ' + jwt\n  }\n  return axios.get(apiHost + '/api/projects', config)\n    .then(function(response){\n      return response.data\n    })\n    .catch(function (error) {\n      return undefined\n  })\n}\n\nfunction createProject(payload) {\n  let config = {\n    headers: {}\n  }\n  if (jwt) {\n    config['headers']['Authorization'] = 'Bearer ' + jwt\n  }\n  return axios.post(apiHost + '/api/projects', payload, config)\n    .then(function(response){\n      return response.data\n    })\n    .catch(function (error) {\n      return undefined\n  })\n}\n\n//####### End Project API #######\n\n//####### Start Todo API #######\n\nfunction getTodos(payload) {\n  var config = {\n    headers: {}\n  }\n  if (jwt) {\n    config['headers']['Authorization'] = 'Bearer ' + jwt\n  }\n  return axios.get(apiHost + '/api/todos', config)\n    .then(function(response){\n      return response.data\n    })\n    .catch(function (error) {\n      return undefined\n  })\n}\n\nfunction createTodo(payload) {\n  let config = {\n    headers: {}\n  }\n  if (jwt) {\n    config['headers']['Authorization'] = 'Bearer ' + jwt\n  }\n  return axios.post(apiHost + '/api/todos', payload, config)\n    .then(function(response){\n      return response.data\n    })\n    .catch(function (error) {\n      return undefined\n  })\n}\n\n//####### End Todo API #######\n\n\n\n\n\n\n\nfunction getAll() {\n    const requestOptions = {\n        method: 'GET',\n        headers: authHeader()\n    };\n\n    return fetch(`/users`, requestOptions).then(handleResponse);\n}\n\nfunction handleResponse(response) {\n    return response.text().then(text => {\n        const data = text && JSON.parse(text);\n        if (!response.ok) {\n            if (response.status === 401) {\n                // auto logout if 401 response returned from api\n                logout();\n                // location.reload(true);\n            }\n\n            const error = (data && data.message) || response.statusText;\n            return Promise.reject(error);\n        }\n\n        return data;\n    });\n}"]},"metadata":{},"sourceType":"module"}